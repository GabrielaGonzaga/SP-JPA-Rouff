<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0"
    />
    <link
      href="https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded"
    />
    <script src="https://code.iconify.design/iconify-icon/1.0.1/iconify-icon.min.js"></script>
    <link rel="stylesheet" type="text/css" th:href="@{/css/newAnimal.css}" />
    <script th:src="@{/js/state.js}" type="text/javascript"></script>
    <title>Novo Animal</title>
  </head>

  <body>
    <nav class="sidebar close">
      <header>
        <div class="image-logo">
          <img th:src="@{/img/hopaper1.png}" alt="" />
        </div>

        <i class="bx bx-chevron-right toggle"></i>
      </header>

      <div class="menu-bar">
        <div class="menu">
          <li class="search-box">
            <i class="bx bx-search icon"></i>
            <input type="text" placeholder="Search..." />
          </li>

          <ul class="menu-links">
            <li class="nav-link">
              <a th:href="@{/admin/dashboard}">
                <i class="bx bx-home-alt icon"></i>
                <span class="text nav-text">Home</span>
              </a>
            </li>

            <li class="nav-link">
              <a href="#">
                <i class="bx bx-bell icon"></i>
                <span class="text nav-text">Solicitações</span>
              </a>
            </li>

            <li class="nav-link">
              <a th:href="@{/admin/animals}">
                <iconify-icon
                  class="icon"
                  icon="ph:paw-print"
                  width="26"
                ></iconify-icon>
                <span class="text nav-text">Animais</span>
              </a>
            </li>

            <li class="nav-link">
              <a>
                <iconify-icon
                  class="icon"
                  icon="la:hand-holding-heart"
                  width="26"
                ></iconify-icon>
                <span class="text nav-text">Adoções</span>
              </a>
            </li>
          </ul>
        </div>

        <div class="bottom-content">
          <li class="">
            <a th:href="@{/logout}">
              <i class="bx bx-log-out icon"></i>
              <span class="text nav-text">Logout</span>
            </a>
          </li>

          <li class="mode">
            <div class="sun-moon">
              <i class="bx bx-moon icon moon"></i>
              <i class="bx bx-sun icon sun"></i>
            </div>
            <span class="mode-text text">Modo escuroㅤ</span>

            <div class="toggle-switch">
              <span class="switch"></span>
            </div>
          </li>
        </div>
      </div>
    </nav>

    <section class="home">
      <div class="content-form">
        <form action="/admin/editAnimal" method="post" enctype="multipart/form-data" class="new">
          <div class="text">Editar Animal</div>
          <div class="content-flex">
            <div class="box1">
              <div class="drop-zone">
                <span class="drop-zone__prompt">
                  Selecione uma
                  <br />
                  imagem aqui!
                </span>
                <input type="file" name="file" class="drop-zone__input" />
              </div>
            </div>
            <div class="box2">
              <div class="form_container">
                <div class="input_wrap">
                  <input
                    placeholder="Nome"
                    type="text"
                    name="nome"
                    class="input"
                    id="nome"
                  />
                </div>
                <div class="input_wrap">
                  <input
                  placeholder="Raça"
                  type="text"
                  name="raca"
                  class="input"
                  id="raca"
                />
                </div>
                <div class="input_wrap">
                  <input
                    placeholder="Data de nascimento"
                    type="date"
                    name="data_nasc"
                    class="input"
                    id="data_nasc"
                  />
                </div>
              </div>
            </div>
          </div>
          <div class="box3">
            <div class="form_container">
              <div class="input_wrap">
                <select name="tipo" id="tipo" class="sel1">
                  <option value="">Tipo</option>
                  <option value="gato">Gato</option>
                  <option value="cachorro">Cachorro</option>
                </select>
              </div>
              <div class="input_wrap" >
                <select name="sexo" id="sexo" class="sel1">
                  <option value="">Sexo</option>
                  <option value="F">Feminino</option>
                  <option value="M">Masculino</option>
                </select>
              </div>
              <div class="input_wrap">
                <select name="porte" id="porte" class="sel1">
                  <option value="">Porte</option>
                  <option value="P">Pequeno</option>
                  <option value="M">Médio</option>
                  <option value="G">Grande</option>
                </select>
              </div>
            </div>

            <div class="form_container">
              <div class="input_wrap">
                <input
                type="text" 
                name="descricao" 
                id="descricao" 
                placeholder="Descrição"
                class="input"
                />
              <div class="input_wrap">
                <select name="estado" id="estado" class="sel2"  onchange="buscaCidades(this.value)">
                  <option value="">Estado</option>
                  <option value="AC">Acre</option>
                  <option value="AL">Alagoas</option>
                  <option value="AP">Amapá</option>
                  <option value="AM">Amazonas</option>
                  <option value="BA">Bahia</option>
                  <option value="CE">Ceará</option>
                  <option value="DF">Distrito Federal</option>
                  <option value="ES">Espírito Santo</option>
                  <option value="GO">Goiás</option>
                  <option value="MA">Maranhão</option>
                  <option value="MT">Mato Grosso</option>
                  <option value="MS">Mato Grosso do Sul</option>
                  <option value="MG">Minas Gerais</option>
                  <option value="PA">Pará</option>
                  <option value="PB">Paraíba</option>
                  <option value="PR">Paraná</option>
                  <option value="PE">Pernambuco</option>
                  <option value="PI">Piauí</option>
                  <option value="RJ">Rio de Janeiro</option>
                  <option value="RN">Rio Grande do Norte</option>
                  <option value="RS">Rio Grande do Sul</option>
                  <option value="RO">Rondônia</option>
                  <option value="RR">Roraima</option>
                  <option value="SC">Santa Catarina</option>
                  <option value="SP">São Paulo</option>
                  <option value="SE">Sergipe</option>
                  <option value="TO">Tocantins</option>
                  <option value="EX">Estrangeiro</option>
                </select>
              </div>
              <div class="input_wrap">
                <select  class="sel2" id="cidade" name="cidade">
                  <option value="">Cidade</option>
                </select>
              </div>
              <div class="button_wrap">
                <button type="submit">Cadastrar</button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </section>
  </body>
</html>

<script>
  const body = document.querySelector('body'),
    sidebar = body.querySelector('nav'),
    toggle = body.querySelector('.toggle'),
    searchBtn = body.querySelector('.search-box'),
    modeSwitch = body.querySelector('.toggle-switch'),
    modeText = body.querySelector('.mode-text')

  toggle.addEventListener('click', () => {
    sidebar.classList.toggle('close')
  })

  searchBtn.addEventListener('click', () => {
    sidebar.classList.remove('close')
  })

  modeSwitch.addEventListener('click', () => {
    body.classList.toggle('dark')

    if (body.classList.contains('dark')) {
      modeText.innerText = 'Modo claro'
    } else {
      modeText.innerText = 'Modo escuroㅤ'
    }
  })
</script>

<script>
  document.querySelectorAll('.drop-zone__input').forEach((inputElement) => {
    const dropZoneElement = inputElement.closest('.drop-zone')

    dropZoneElement.addEventListener('click', (e) => {
      inputElement.click()
    })

    inputElement.addEventListener('change', (e) => {
      if (inputElement.files.length) {
        updateThumbnail(dropZoneElement, inputElement.files[0])
      }
    })

    dropZoneElement.addEventListener('dragover', (e) => {
      e.preventDefault()
      dropZoneElement.classList.add('drop-zone--over')
    })

    ;['dragleave', 'dragend'].forEach((type) => {
      dropZoneElement.addEventListener(type, (e) => {
        dropZoneElement.classList.remove('drop-zone--over')
      })
    })

    dropZoneElement.addEventListener('drop', (e) => {
      e.preventDefault()

      if (e.dataTransfer.files.length) {
        inputElement.files = e.dataTransfer.files
        updateThumbnail(dropZoneElement, e.dataTransfer.files[0])
      }

      dropZoneElement.classList.remove('drop-zone--over')
    })
  })

  function updateThumbnail(dropZoneElement, file) {
    let thumbnailElement = dropZoneElement.querySelector('.drop-zone__thumb')

    if (dropZoneElement.querySelector('.drop-zone__prompt')) {
      dropZoneElement.querySelector('.drop-zone__prompt').remove()
    }

    if (!thumbnailElement) {
      thumbnailElement = document.createElement('div')
      thumbnailElement.classList.add('drop-zone__thumb')
      dropZoneElement.appendChild(thumbnailElement)
    }

    thumbnailElement.dataset.label = file.name

    if (file.type.startsWith('image/')) {
      const reader = new FileReader()

      reader.readAsDataURL(file)
      reader.onload = () => {
        thumbnailElement.style.backgroundImage = `url('${reader.result}')`
      }
    } else {
      thumbnailElement.style.backgroundImage = null
    }
  }
</script>

<script>
  $(document).ready(function () {
    $('.card #btn-open').on('click', function (event) {
      event.preventDefault()
      var href = $(this).attr('href')

      $.get(href, function (animal, status) {
        $('.maForm #id').val(animal.id)
        $('.maForm #nome').val(animal.nome)
        $('.maForm #raca').val(animal.raca)
        $('.maForm #sexo').val(animal.sexo)
        $('.maForm #desc').val(animal.descricao)
        $('.maForm #cidade').val(animal.cidade)
        $('.maForm #estado').val(animal.estado)
        $('.maForm #img').src(
          "*{'data:image/jpeg;base64,+${" + animal.imagem + '}}',
        )
      })
      $('#staticBackdrop').modal()
    })
  })
</script>
